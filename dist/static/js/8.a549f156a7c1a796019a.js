webpackJsonp([8],{469:function(t,e,a){function r(t){a(952)}var s=a(25)(a(915),a(973),r,null,null);t.exports=s.exports},915:function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var a=arguments[e];for(var r in a)Object.prototype.hasOwnProperty.call(a,r)&&(t[r]=a[r])}return t},s=a(73);e.default={data:function(){return{strate_info:{is_start_client:0,is_ask_server:0,m_rule_id:0,t_rule_id:0,u_rule_ids:[],name:""}}},methods:{strate_new:function(){var t=this;this.strate_info.u_rule_ids=this.strate_datarule_list.filter(function(t){return 1===t.status}).map(function(t){return t.id}),this.$valid([{valid:this.strate_info.name.length>3,msg:"请确认策略名称长度不少于4位"},{valid:this.strate_info.name.length<17,msg:"请确认策略名称长度不超过16位"},{valid:this.$rules.name_rule(this.strate_info.name),msg:"请确认策略名称不包含特殊字符"},{valid:this.strate_info.u_rule_ids.length,msg:"请至少选择一组数据上传策略"}]).then(function(){t.$store.dispatch("stratery/strateCreate",t.strate_info)})},new_strate_device:function(){this.$router.push({path:"/config/strate_device"})},new_strate_rule:function(){this.$router.push({path:"/config/strate_rule"})},new_strate_data:function(){this.$router.push({path:"/config/strate_data"})},strate_device_del:function(t){var e=this;this.$confirm("请确认是否删除该条划定设备?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){e.$store.dispatch("stratery/strateDeviceDelele",{id:t})})},strate_rule_del:function(t){var e=this;this.$confirm("请确认是否删除该条策略更新规则?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){e.$store.dispatch("stratery/strateUpdateDelele",{id:t})})},strate_data_del:function(t){var e=this;this.$confirm("请确认是否删除该条数据上传策略?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){e.$store.dispatch("stratery/strateDataDelele",{id:t})})}},computed:r({},(0,s.mapState)("stratery",["strate_device_list","strate_rule_list","strate_datarule_list"])),watch:{strate_device_list:function(t){t[0]&&(this.strate_info.m_rule_id=t[0].id)},strate_rule_list:function(t){t[0]&&(this.strate_info.t_rule_id=t[0].id)}},created:function(){this.$store.dispatch("stratery/strateDeviceList"),this.$store.dispatch("stratery/strateRuleList"),this.$store.dispatch("stratery/strateDataruleList")}}},935:function(t,e,a){e=t.exports=a(459)(!1),e.push([t.i,".page_strate_new .page_strate_info{margin:10px auto}.page_strate_new .checkbox_config{margin:20px auto 30px}.page_strate_new .table_box{margin-bottom:40px}.page_strate_new .page_body{position:relative}.page_strate_new .cell{padding:0 2px}.page_strate_new .tag_parnode{padding:4px}.page_strate_new .strate_content{margin-top:30px}.page_strate_new .l_h_30{line-height:30px}.page_strate_new .col_1,.page_strate_new .col_2,.page_strate_new .col_3{height:35px;line-height:35px}.page_strate_new .col_1{text-align:left}.page_strate_new .col_2{text-align:center;font-size:15px}.page_strate_new .col_3{text-align:right}.page_strate_new .title_button_layout .strate_module_title{line-height:34px;font-size:16px;font-weight:700}.page_strate_new .title_button_layout .t_a_r{text-align:right}",""])},952:function(t,e,a){var r=a(935);"string"==typeof r&&(r=[[t.i,r,""]]),r.locals&&(t.exports=r.locals);a(460)("599eedf0",r,!0)},973:function(t,e){t.exports={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"page_inner page_strate_new"},[a("div",{staticClass:"page_head"},[a("el-breadcrumb",{attrs:{separator:">"}},[a("el-breadcrumb-item",{attrs:{to:{path:"/config/stratery"}}},[t._v("策略组列表")]),t._v(" "),a("el-breadcrumb-item",{attrs:{to:{path:"/config/strates_chg"}}},[t._v("更改策略组")]),t._v(" "),a("el-breadcrumb-item",{attrs:{to:{path:"/config/strates_new"}}},[t._v("新建策略组")]),t._v(" "),a("el-breadcrumb-item",{attrs:{to:{path:"/config/strate_new"}}},[t._v("新建策略")])],1)],1),t._v(" "),a("div",{staticClass:"page_body"},[a("div",{staticClass:"page_strate_info"},[a("el-row",{attrs:{align:"bottom"}},[a("el-col",{attrs:{span:8}},[a("div",{staticClass:"col_1"},[a("el-input",{attrs:{placeholder:"请输入策略名称"},model:{value:t.strate_info.name,callback:function(e){t.strate_info.name=e},expression:"strate_info.name"}})],1)]),t._v(" "),a("el-col",{staticClass:"l_h_30",attrs:{span:4,offset:1}},[a("el-checkbox",{attrs:{"true-label":1,"false-label":0},model:{value:t.strate_info.is_start_client,callback:function(e){t.strate_info.is_start_client=e},expression:"strate_info.is_start_client"}},[t._v("启动探针\n          ")])],1),t._v(" "),a("el-col",{staticClass:"l_h_30",attrs:{span:4}},[a("el-checkbox",{attrs:{"true-label":1,"false-label":0},model:{value:t.strate_info.is_ask_server,callback:function(e){t.strate_info.is_ask_server=e},expression:"strate_info.is_ask_server"}},[t._v("上传数据前询问服务器\n          ")])],1),t._v(" "),a("el-col",{attrs:{span:7}},[a("div",{staticClass:"col_3"},[a("el-button",{attrs:{type:"success"},on:{click:t.strate_new}},[t._v("生成策略")])],1)])],1)],1),t._v(" "),a("div",{staticClass:"strate_content"},[a("div",{staticClass:"strate_device"},[a("div",{staticClass:"title_button_layout"},[a("el-row",[a("el-col",{attrs:{span:5}},[a("div",{staticClass:"strate_module_title"},[t._v("1.划定设备")])]),t._v(" "),a("el-col",{attrs:{span:4,offset:15}},[a("div",{staticClass:"t_a_r"},[a("el-button",{attrs:{size:"small",type:"primary"},on:{click:t.new_strate_device}},[t._v("新建")])],1)])],1)],1),t._v(" "),a("div",{staticClass:"table_box"},[a("el-table",{staticStyle:{width:"100%"},attrs:{stripe:!0,border:"","highlight-current-row":!1,data:t.strate_device_list}},[a("el-table-column",{attrs:{width:"60",align:"center",label:"选择"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("el-radio",{attrs:{label:e.row.id},model:{value:t.strate_info.m_rule_id,callback:function(e){t.strate_info.m_rule_id=e},expression:"strate_info.m_rule_id"}},[t._v("\n                  "+t._s("")+"\n                ")])]}}])}),t._v(" "),a("el-table-column",{attrs:{label:"序号",width:"60",align:"center",prop:"_order"}}),t._v(" "),a("el-table-column",{attrs:{label:"名称",width:"200",align:"center",prop:"name"}}),t._v(" "),a("el-table-column",{attrs:{prop:"location",label:"地域",align:"center"},scopedSlots:t._u([{key:"default",fn:function(e){return[e.row.location.includes(",")?[a("el-tag",{attrs:{type:"primary"},domProps:{textContent:t._s(e.row.location.split(",")[0])}}),t._v(" "),a("el-popover",{attrs:{placement:"left",width:"160",trigger:"hover"}},[a("div",{staticClass:"basic_popover"},[t._l(e.row.location.split(","),function(e){return[a("el-tag",{attrs:{type:"primary"},domProps:{textContent:t._s(e)}})]})],2),t._v(" "),a("el-button",{attrs:{type:"text",icon:"more"},slot:"reference"})],1)]:[a("el-tag",{attrs:{type:"primary"},domProps:{textContent:t._s(e.row.location.split(",")[0])}}),t._v(" "),a("span",{staticClass:"opacity_0"},[a("el-button",{attrs:{type:"text",icon:"more"}})],1)]]}}])}),t._v(" "),a("el-table-column",{attrs:{prop:"manufacturer",label:"设备品牌",align:"center"},scopedSlots:t._u([{key:"default",fn:function(e){return[e.row.manufacturer.includes(",")?[a("el-tag",{attrs:{type:"primary"},domProps:{textContent:t._s(e.row.manufacturer.split(",")[0])}}),t._v(" "),a("el-popover",{attrs:{placement:"right",width:"160",trigger:"hover"}},[a("div",{staticClass:"basic_popover"},[t._l(e.row.manufacturer.split(","),function(e){return[a("el-tag",{attrs:{type:"primary"},domProps:{textContent:t._s(e)}})]})],2),t._v(" "),a("el-button",{attrs:{type:"text",icon:"more"},slot:"reference"})],1)]:[a("el-tag",{attrs:{type:"primary"},domProps:{textContent:t._s(e.row.manufacturer.split(",")[0])}}),t._v(" "),a("span",{staticClass:"opacity_0"},[a("el-button",{attrs:{type:"text",icon:"more"}})],1)]]}}])}),t._v(" "),a("el-table-column",{attrs:{label:"系统",align:"center"},scopedSlots:t._u([{key:"default",fn:function(e){return[e.row.os_version.includes(",")?[a("el-tag",{attrs:{type:"primary"},domProps:{textContent:t._s(e.row.os_version.split(",")[0])}}),t._v(" "),a("el-popover",{attrs:{placement:"right",width:"160",trigger:"hover"}},[a("div",{staticClass:"basic_popover"},[t._l(e.row.os_version.split(","),function(e){return[a("el-tag",{attrs:{type:"primary"},domProps:{textContent:t._s(e)}})]})],2),t._v(" "),a("el-button",{attrs:{type:"text",icon:"more"},slot:"reference"})],1)]:[a("el-tag",{attrs:{type:"primary"},domProps:{textContent:t._s(e.row.os_version.split(",")[0])}}),t._v(" "),a("span",{staticClass:"opacity_0"},[a("el-button",{attrs:{type:"text",icon:"more"}})],1)]]}}])}),t._v(" "),a("el-table-column",{attrs:{label:"APP版本",align:"center"},scopedSlots:t._u([{key:"default",fn:function(e){return[e.row.app_version.includes(",")?[a("el-tag",{attrs:{type:"primary"},domProps:{textContent:t._s(e.row.app_version.split(",")[0])}}),t._v(" "),a("el-popover",{attrs:{placement:"right",width:"160",trigger:"hover"}},[a("div",{staticClass:"basic_popover"},[t._l(e.row.app_version.split(","),function(e){return[a("el-tag",{attrs:{type:"primary"},domProps:{textContent:t._s(e)}})]})],2),t._v(" "),a("el-button",{attrs:{type:"text",icon:"more"},slot:"reference"})],1)]:[a("el-tag",{attrs:{type:"primary"},domProps:{textContent:t._s(e.row.app_version.split(",")[0])}}),t._v(" "),a("span",{staticClass:"opacity_0"},[a("el-button",{attrs:{type:"text",icon:"more"}})],1)]]}}])}),t._v(" "),a("el-table-column",{attrs:{label:"ROOT",align:"center"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("span",[t._v("\n                  "+t._s(e.row.is_root?"是":"否")+"\n                ")])]}}])}),t._v(" "),a("el-table-column",{attrs:{label:"操作",width:"100",align:"center"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("i",{staticClass:"icon_edit iconfont icon-laji",on:{click:function(a){t.strate_device_del(e.row.id)}}})]}}])})],1)],1)]),t._v(" "),a("div",{staticClass:"strate_newrule"},[a("div",{staticClass:"title_button_layout"},[a("el-row",[a("el-col",{attrs:{span:5}},[a("div",{staticClass:"strate_module_title"},[t._v("2.策略更新规则")])]),t._v(" "),a("el-col",{attrs:{span:4,offset:15}},[a("div",{staticClass:"t_a_r"},[a("el-button",{attrs:{size:"small",type:"primary"},on:{click:t.new_strate_rule}},[t._v("新建")])],1)])],1)],1),t._v(" "),a("div",{staticClass:"table_box"},[a("el-table",{staticStyle:{width:"100%"},attrs:{stripe:!0,border:"","highlight-current-row":!1,data:t.strate_rule_list}},[a("el-table-column",{attrs:{width:"60",align:"center",label:"选择"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("el-radio",{attrs:{label:e.row.id},model:{value:t.strate_info.t_rule_id,callback:function(e){t.strate_info.t_rule_id=e},expression:"strate_info.t_rule_id"}},[t._v("\n                  "+t._s("")+"\n                ")])]}}])}),t._v(" "),a("el-table-column",{attrs:{label:"序号",width:"60",align:"center",prop:"_order"}}),t._v(" "),a("el-table-column",{attrs:{label:"名称",width:"200",align:"center",prop:"name"}}),t._v(" "),a("el-table-column",{attrs:{label:"更新频率",align:"center"},scopedSlots:t._u([{key:"default",fn:function(e){return[e.row.r_hours%720?e.row.r_hours%168?e.row.r_hours%24?a("span",[t._v("\n                  "+t._s(e.row.r_hours+" 时")+"\n                ")]):a("span",[t._v("\n                  "+t._s(e.row.r_hours/24+" 天")+"\n                ")]):a("span",[t._v("\n                  "+t._s(e.row.r_hours/7/24+" 周")+"\n                ")]):a("span",[t._v("\n                  "+t._s(e.row.r_hours/30/24+" 月")+"\n                ")])]}}])}),t._v(" "),a("el-table-column",{attrs:{label:"更新失败处理",align:"center"},scopedSlots:t._u([{key:"default",fn:function(e){return[e.row.is_try?a("span",[t._v("\n                  "+t._s("尝试"+e.row.try_count+"次/"+e.row.hours+"小时")+"\n                ")]):a("span",[t._v("\n                  放弃\n                ")])]}}])}),t._v(" "),a("el-table-column",{attrs:{label:"操作",width:"100",align:"center"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("i",{staticClass:"icon_edit iconfont icon-laji",on:{click:function(a){t.strate_rule_del(e.row.id)}}})]}}])})],1)],1)]),t._v(" "),a("div",{staticClass:"strate_datarule"},[a("div",{staticClass:"title_button_layout"},[a("el-row",[a("el-col",{attrs:{span:5}},[a("div",{staticClass:"strate_module_title"},[t._v("3.数据上传策略")])]),t._v(" "),a("el-col",{attrs:{span:4,offset:15}},[a("div",{staticClass:"t_a_r"},[a("el-button",{attrs:{size:"small",type:"primary"},on:{click:t.new_strate_data}},[t._v("新建")])],1)])],1)],1),t._v(" "),a("div",{staticClass:"table_box"},[a("el-table",{staticStyle:{width:"100%"},attrs:{stripe:!0,border:"","highlight-current-row":!1,data:t.strate_datarule_list}},[a("el-table-column",{attrs:{width:"60",align:"center",label:"选择"},scopedSlots:t._u([{key:"default",fn:function(t){return[a("el-checkbox",{attrs:{"true-label":1,"false-label":0},model:{value:t.row.status,callback:function(e){t.row.status=e},expression:"scope.row.status"}})]}}])}),t._v(" "),a("el-table-column",{attrs:{label:"序号",width:"60",align:"center",prop:"_order"}}),t._v(" "),a("el-table-column",{attrs:{label:"名称",width:"200",align:"center",prop:"name"}}),t._v(" "),a("el-table-column",{attrs:{label:"事件类型",align:"center",width:"200"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("div",{domProps:{textContent:t._s(e.row.names.join("/"))}})]}}])}),t._v(" "),a("el-table-column",{attrs:{label:"数据上传规则",align:"center"},scopedSlots:t._u([{key:"default",fn:function(e){return[e.row.is_immediate?a("span",[t._v("\n                  "+t._s(e.row.name+" (立即/最近"+e.row.num+"条/不超过"+e.row.maxsize+"MB)")+"\n                ")]):a("span",[t._v("\n                  "+t._s(e.row.name+" (定时/最近"+e.row.num+"条/不超过"+e.row.maxsize+"MB)")+"\n                ")])]}}])}),t._v(" "),a("el-table-column",{attrs:{label:"操作",width:"100",align:"center"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("i",{staticClass:"icon_edit iconfont icon-laji",on:{click:function(a){t.strate_data_del(e.row.id)}}})]}}])})],1)],1)])])])])},staticRenderFns:[]}}});